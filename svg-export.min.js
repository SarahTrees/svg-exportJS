(function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):(t="undefined"!=typeof globalThis?globalThis:t||self,e(t.svgExport=t.svgExport||{}))})(this,function(t){"use strict";function e(t){var e=document.createElement("div");if(e.className="tempdiv-svg-exportJS","string"==typeof t&&(e.innerHTML=t.trim(),t=e.firstChild),!t.nodeType||1!==t.nodeType)return console.log("Error svg-export: The input svg was not recognized"),null;var o=t.cloneNode(!0);return o.style.display=null,e.appendChild(o),e.style.visibility="hidden",e.style.display="table",e.style.position="absolute",document.body.appendChild(e),o}function o(t){t&&t.pdfOptions&&(Object.keys(h.pdfOptions).forEach(function(e){if(t.pdfOptions.hasOwnProperty(e)&&typeof t.pdfOptions[e]==typeof h.pdfOptions[e]){if(""===t.pdfOptions[e])return;h.pdfOptions[e]=t.pdfOptions[e]}}),h.pdfOptions.pageLayout.margin||(h.pdfOptions.pageLayout.margin=50),h.pdfOptions.pageLayout.margins||(h.pdfOptions.pageLayout.margins={})),h.pdfOptions.pageLayout.margins.top=h.pdfOptions.pageLayout.margins.top||h.pdfOptions.pageLayout.margin,h.pdfOptions.pageLayout.margins.bottom=h.pdfOptions.pageLayout.margins.bottom||h.pdfOptions.pageLayout.margin,h.pdfOptions.pageLayout.margins.left=h.pdfOptions.pageLayout.margins.left||h.pdfOptions.pageLayout.margin,h.pdfOptions.pageLayout.margins.right=h.pdfOptions.pageLayout.margins.top||h.pdfOptions.pageLayout.margin,delete h.pdfOptions.pageLayout.margin,t&&h.pdfOptions.pageLayout.size||(h.pdfOptions.pageLayout.size=[Math.max(300,h.width)+h.pdfOptions.pageLayout.margins.left+h.pdfOptions.pageLayout.margins.right,Math.max(300,h.height)+h.pdfOptions.pageLayout.margins.top+h.pdfOptions.pageLayout.margins.bottom+(h.pdfOptions.addTitleToPage?2*h.pdfOptions.pdfTitleFontSize+10:0)+(""!==h.pdfOptions.chartCaption?4*h.pdfOptions.pdfCaptionFontSize+10:0)])}function n(t,e){h={originalWidth:100,originalHeight:100,width:100,height:100,scale:1,useCSS:!0,transparentBackgroundReplace:"white",pdfOptions:{customFonts:[],pageLayout:{margin:50,margins:{}},addTitleToPage:!0,chartCaption:"",pdfTextFontFamily:"Helvetica",pdfTitleFontSize:20,pdfCaptionFontSize:14}},h.originalHeight=-1!==t.style.getPropertyValue("height").indexOf("%")||t.getAttribute("height")&&-1!==t.getAttribute("height").indexOf("%")?t.getBBox().height*h.scale:t.getBoundingClientRect().height*h.scale,h.originalWidth=-1!==t.style.getPropertyValue("width").indexOf("%")||t.getAttribute("width")&&-1!==t.getAttribute("width").indexOf("%")?t.getBBox().width*h.scale:t.getBoundingClientRect().width*h.scale,e&&e.scale&&"number"==typeof e.scale&&(h.scale=e.scale),e&&e.height?"number"==typeof e.height&&(h.height=e.height*h.scale):h.height=h.originalHeight*h.scale,e&&e.width?"number"==typeof e.width&&(h.width=e.width*h.scale):h.width=h.originalWidth*h.scale,e&&!1===e.useCSS&&(h.useCSS=!1),e&&e.transparentBackgroundReplace&&(h.transparentBackgroundReplace=e.transparentBackgroundReplace),o(e)}function i(t,e){if("function"==typeof getComputedStyle){t.childNodes.forEach(function(t,o){1===t.nodeType&&i(t,e.childNodes[parseInt(o)])});var o=window.getComputedStyle(t);o.forEach(function(t){-1===["width","height","inline-size","block-size"].indexOf(t)&&e.style.setProperty(t,o.getPropertyValue(t))})}else console.log("Warning svg-export: this browser is not able to get computed styles")}function a(t,e,o){void 0===o&&(o=!0),h.useCSS&&"object"==typeof e&&(i(e,t),t.style.display=null),t.style.width=null,t.style.height=null,t.setAttribute("width",h.width),t.setAttribute("height",h.height),t.setAttribute("preserveAspectRatio","none"),t.setAttribute("viewBox","0 0 "+h.originalWidth+" "+h.originalHeight);for(var n=document.getElementsByClassName("tempdiv-svg-exportJS");n.length>0;)n[0].parentNode.removeChild(n[0]);if(o){var a=new XMLSerializer,p=a.serializeToString(t).replace(/currentColor/g,"black");return p.match(/^<svg[^>]+xmlns="http\:\/\/www\.w3\.org\/2000\/svg"/)||(p=p.replace(/^<svg/,'<svg xmlns="http://www.w3.org/2000/svg"')),p.match(/^<svg[^>]+"http\:\/\/www\.w3\.org\/1999\/xlink"/)||(p=p.replace(/^<svg/,'<svg xmlns:xlink="http://www.w3.org/1999/xlink"')),p}return t}function p(t){var e=[];return t.forEach(function(t){var o=new Promise(function(e,o){var n=new XMLHttpRequest;n.onreadystatechange=function(){4===n.readyState&&200===n.status&&e(n.response)},n.open("GET",t,!0),n.responseType="arraybuffer",n.send(null)});e.push(o)}),e}function s(t,e,o){if(e=e.replace(/[/\\?%*:|"<>]/g,"_"),navigator.msSaveBlob){for(var n=decodeURIComponent(t.split(",")[1]),i=[],a=t.split(",")[0].split(":")[1].split(";")[0],p=0;p<n.length;p++)i.push(n.charCodeAt(p));var s=null;return s=null!=o?o.msToBlob():new Blob([new Uint8Array(i)],{type:a}),navigator.msSaveBlob(s,e)}var r=document.createElement("a");r.download=e,r.href=t,document.body.appendChild(r),r.click(),document.body.removeChild(r)}function r(t,o,i){var p=e(t);if(p){null==o&&(o="chart"),n(p,i);var r=a(p,t);r='<?xml version="1.0" standalone="no"?>\r\n'+r;var d="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(r);s(d,o+".svg")}}function d(t,o,i,p){if("object"==typeof canvg){p=p.toLowerCase().replace("jpg","jpeg"),"png"!==p&&"jpeg"!==p&&(p="png");var r=e(t);if(r){null==o&&(o="chart");var d=document.createElement("canvas");i&&(i.width||i.height)||(i||(i={}),i.scale=10),n(r,i);var g=a(r,t);console.log(r),console.log(h.width),"jpeg"===p&&(g=g.replace(">",'><rect x="0" y="0" width="'+h.width+'" height="'+h.height+'" fill="'+h.transparentBackgroundReplace+'"/>'));var l=d.getContext("2d");canvg.Canvg.fromString(l,g).start();var f=d.toDataURL("image/"+p);s(f,o+"."+p,d)}}else console.log("Error svg-export: PNG/JPEG export requires Canvg.js")}function g(t,e,o){d(t,e,o,"png")}function l(t,e,o){d(t,e,o,"jpeg")}function f(t,e,o){h.pdfOptions.addTitleToPage&&t.font(h.pdfOptions.pdfTextFontFamily).fontSize(h.pdfOptions.pdfTitleFontSize).text(e,{width:h.pdfOptions.pageLayout.size[0]-h.pdfOptions.pageLayout.margins.left-h.pdfOptions.pageLayout.margins.right}),SVGtoPDF(t,o,h.pdfOptions.pageLayout.margins.left,t.y+10,{width:h.width,height:h.height,preserveAspectRatio:"none",useCSS:h.useCSS}),""!==h.pdfOptions.chartCaption&&t.font(h.pdfOptions.pdfTextFontFamily).fontSize(h.pdfOptions.pdfCaptionFontSize).text(h.pdfOptions.chartCaption,h.pdfOptions.pageLayout.margins.left,h.pdfOptions.pageLayout.size[1]-h.pdfOptions.pageLayout.margins.bottom-4*h.pdfOptions.pdfCaptionFontSize,{width:h.pdfOptions.pageLayout.size[0]-h.pdfOptions.pageLayout.margins.left-h.pdfOptions.pageLayout.margins.right})}function u(t,o,i){if("function"==typeof PDFDocument&&"function"==typeof SVGtoPDF&&"function"==typeof blobStream){var r=e(t);if(r){null==o&&(o="chart"),n(r,i);var d=a(r,t,!1),g=new PDFDocument(h.pdfOptions.pageLayout),l=g.pipe(blobStream());if(h.pdfOptions.customFonts.length>0){var u=p(h.pdfOptions.customFonts.map(function(t){return t.url}));Promise.all(u).then(function(t){t.forEach(function(t,e){var o=h.pdfOptions.customFonts[parseInt(e)],n=d.querySelectorAll('[style*="'+o.fontName+'"]');n.forEach(function(t){t.style.fontFamily=o.fontName}),-1===o.url.indexOf(".ttc")&&-1===o.url.indexOf(".dfont")||!o.styleName?g.registerFont(o.fontName,t):g.registerFont(o.fontName,t,o.styleName)}),f(g,o,d),g.end()})}else f(g,o,d),g.end();l.on("finish",function(){var t=l.toBlobURL("application/pdf");s(t,o+".pdf")})}}else console.log("Error svg-export: PDF export requires PDFKit.js, blob-stream and SVG-to-PDFKit")}var c="1.0.0",h={};t.version=c,t.downloadSvg=r,t.downloadPng=g,t.downloadJpeg=l,t.downloadPdf=u,Object.defineProperty(t,"__esModule",{value:!0})});