(function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):(t="undefined"!=typeof globalThis?globalThis:t||self,e(t.svgExport=t.svgExport||{}))})(this,function(t){"use strict";function e(t){t&&t.pdfOptions&&(Object.keys(c.pdfOptions).forEach(function(e){if(t.pdfOptions.hasOwnProperty(e)&&typeof t.pdfOptions[e]==typeof c.pdfOptions[e]){if(""===t.pdfOptions[e])return;c.pdfOptions[e]=t.pdfOptions[e]}}),c.pdfOptions.pageLayout.margin||(c.pdfOptions.pageLayout.margin=50),c.pdfOptions.pageLayout.margins||(c.pdfOptions.pageLayout.margins={})),c.pdfOptions.pageLayout.margins.top=c.pdfOptions.pageLayout.margins.top||c.pdfOptions.pageLayout.margin,c.pdfOptions.pageLayout.margins.bottom=c.pdfOptions.pageLayout.margins.bottom||c.pdfOptions.pageLayout.margin,c.pdfOptions.pageLayout.margins.left=c.pdfOptions.pageLayout.margins.left||c.pdfOptions.pageLayout.margin,c.pdfOptions.pageLayout.margins.right=c.pdfOptions.pageLayout.margins.top||c.pdfOptions.pageLayout.margin,delete c.pdfOptions.pageLayout.margin,t&&c.pdfOptions.pageLayout.size||(c.pdfOptions.pageLayout.size=[c.width+c.pdfOptions.pageLayout.margins.left+c.pdfOptions.pageLayout.margins.right,c.height+c.pdfOptions.pageLayout.margins.top+c.pdfOptions.pageLayout.margins.bottom+(c.pdfOptions.addTitleToPage?2*c.pdfOptions.pdfTitleFontSize+10:0)+(""!==c.pdfOptions.chartCaption?4*c.pdfOptions.pdfCaptionFontSize+10:0)])}function o(t,o){c={width:100,height:100,scale:1,useCSS:!0,transparentBackgroundReplace:"white",pdfOptions:{customFonts:[],pageLayout:{margin:50,margins:{}},addTitleToPage:!0,chartCaption:"",pdfTextFontFamily:"Helvetica",pdfTitleFontSize:20,pdfCaptionFontSize:14}},o&&o.scale&&"number"==typeof o.scale&&(c.scale=o.scale),o&&o.height?"number"==typeof o.height&&(c.height=o.height*c.scale):c.height=document.querySelector(t).getBBox().height*c.scale,o&&o.width?"number"==typeof o.width&&(c.width=o.width*c.scale):c.width=document.querySelector(t).getBBox().width*c.scale,o&&!1===o.useCSS&&(c.useCSS=!1),o&&o.transparentBackgroundReplace&&(c.transparentBackgroundReplace=o.transparentBackgroundReplace),e(o)}function n(t,e){if("function"==typeof getComputedStyle){t.children.forEach(function(t,o){n(t,e.children[parseInt(o)])});var o=window.getComputedStyle(t);o.forEach(function(t){-1===["width","height","inline-size","block-size"].indexOf(t)&&e.style.setProperty(t,o.getPropertyValue(t))})}else alert("Warning svg-export: this browser is not able to get computed styles")}function i(t,e=!0){var o=document.querySelector(t).cloneNode(!0);if(c.useCSS&&n(document.querySelector(t),o),o.setAttribute("width",c.width),o.setAttribute("height",c.height),o.setAttribute("preserveAspectRatio","none"),o.setAttribute("viewBox","0 0 "+document.querySelector(t).getBBox().width+" "+document.querySelector(t).getBBox().height),e){var i=new XMLSerializer,a=i.serializeToString(o).replace(/currentColor/g,"black");return a.match(/^<svg[^>]+xmlns="http\:\/\/www\.w3\.org\/2000\/svg"/)||(a=a.replace(/^<svg/,'<svg xmlns="http://www.w3.org/2000/svg"')),a.match(/^<svg[^>]+"http\:\/\/www\.w3\.org\/1999\/xlink"/)||(a=a.replace(/^<svg/,'<svg xmlns:xlink="http://www.w3.org/1999/xlink"')),a}return o}function a(t){var e=[];return t.forEach(function(t){var o=new Promise(function(e,o){var n=new XMLHttpRequest;n.onreadystatechange=function(){4===n.readyState&&200===n.status&&e(n.response)},n.open("GET",t,!0),n.responseType="arraybuffer",n.send(null)});e.push(o)}),e}function p(t,e,o){if(e=e.replace(/[/\\?%*:|"<>]/g,"_"),navigator.msSaveBlob){for(var n=decodeURIComponent(t.split(",")[1]),i=[],a=t.split(",")[0].split(":")[1].split(";")[0],p=0;p<n.length;p++)i.push(n.charCodeAt(p));var r=null;return r=null!=o?o.msToBlob():new Blob([new Uint8Array(i)],{type:a}),navigator.msSaveBlob(r,e)}var s=document.createElement("a");s.download=e,s.href=t,document.body.appendChild(s),s.click(),document.body.removeChild(s)}function r(t,e,n){null==e&&(e="chart"),o(t,n);var a=i(t);a='<?xml version="1.0" standalone="no"?>\r\n'+a;var r="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(a);p(r,e+".svg")}function s(t,e,n,a){if("object"==typeof canvg){a=a.toLowerCase().replace("jpg","jpeg"),"png"!==a&&"jpeg"!==a&&(a="png"),null==e&&(e="chart");var r=document.createElement("canvas");n&&(n.width||n.height)||(n||(n={}),n.scale=10),o(t,n);var s=i(t);"jpeg"===a&&(s=s.replace(">",'><rect x="0" y="0" width="'+c.width+'" height="'+c.height+'" fill="'+c.transparentBackgroundReplace+'"/>'));var f=r.getContext("2d");canvg.Canvg.fromString(f,s).start();var d=r.toDataURL("image/"+a);p(d,e+"."+a,r)}else alert("Error svg-export: PNG/JPEG export requires Canvg.js")}function f(t,e,o){s(t,e,o,"png")}function d(t,e,o){s(t,e,o,"jpeg")}function g(t,e,o){c.pdfOptions.addTitleToPage&&t.font(c.pdfOptions.pdfTextFontFamily).fontSize(c.pdfOptions.pdfTitleFontSize).text(e,{width:c.pdfOptions.pageLayout.size[0]-c.pdfOptions.pageLayout.margins.left-c.pdfOptions.pageLayout.margins.right}),SVGtoPDF(t,o,c.pdfOptions.pageLayout.margins.left,t.y+10,{width:c.width,height:c.height,preserveAspectRatio:"none",useCSS:c.useCSS}),""!==c.pdfOptions.chartCaption&&t.font(c.pdfOptions.pdfTextFontFamily).fontSize(c.pdfOptions.pdfCaptionFontSize).text(c.pdfOptions.chartCaption,c.pdfOptions.pageLayout.margins.left,c.pdfOptions.pageLayout.size[1]-c.pdfOptions.pageLayout.margins.bottom-4*c.pdfOptions.pdfCaptionFontSize,{width:c.pdfOptions.pageLayout.size[0]-c.pdfOptions.pageLayout.margins.left-c.pdfOptions.pageLayout.margins.right})}function u(t,e,n){if("function"==typeof PDFDocument&&"function"==typeof SVGtoPDF&&"function"==typeof blobStream){null==e&&(e="chart"),o(t,n);var r=i(t,!1),s=new PDFDocument(c.pdfOptions.pageLayout),f=s.pipe(blobStream());if(c.pdfOptions.customFonts.length>0){var d=a(c.pdfOptions.customFonts.map(function(t){return t.url}));Promise.all(d).then(function(t){t.forEach(function(t,e){var o=c.pdfOptions.customFonts[parseInt(e)],n=r.querySelectorAll('[style*="'+o.fontName+'"]');n.forEach(function(t){t.style.fontFamily=o.fontName}),-1===o.url.indexOf(".ttc")&&-1===o.url.indexOf(".dfont")||!o.styleName?s.registerFont(o.fontName,t):s.registerFont(o.fontName,t,o.styleName)}),g(s,e,r),s.end()})}else g(s,e,r),s.end();f.on("finish",function(){var t=f.toBlobURL("application/pdf");p(t,e+".pdf")})}else alert("Error svg-export: PDF export requires PDFKit.js, blob-stream and SVG-to-PDFKit")}var l="1.0.0",c={};t.version=l,t.downloadSvg=r,t.downloadPng=f,t.downloadJpeg=d,t.downloadPdf=u,Object.defineProperty(t,"__esModule",{value:!0})});