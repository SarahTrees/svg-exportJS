(function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):(t="undefined"!=typeof globalThis?globalThis:t||self,e(t.svgExport=t.svgExport||{}))})(this,function(t){"use strict";function e(t){t&&t.pdfOptions&&(Object.keys(c.pdfOptions).forEach(function(e){if(t.pdfOptions.hasOwnProperty(e)&&typeof t.pdfOptions[e]==typeof c.pdfOptions[e]){if(""===t.pdfOptions[e])return;c.pdfOptions[e]=t.pdfOptions[e]}}),c.pdfOptions.pageLayout.margin||(c.pdfOptions.pageLayout.margin=50),c.pdfOptions.pageLayout.margins||(c.pdfOptions.pageLayout.margins={})),c.pdfOptions.pageLayout.margins.top=c.pdfOptions.pageLayout.margins.top||c.pdfOptions.pageLayout.margin,c.pdfOptions.pageLayout.margins.bottom=c.pdfOptions.pageLayout.margins.bottom||c.pdfOptions.pageLayout.margin,c.pdfOptions.pageLayout.margins.left=c.pdfOptions.pageLayout.margins.left||c.pdfOptions.pageLayout.margin,c.pdfOptions.pageLayout.margins.right=c.pdfOptions.pageLayout.margins.top||c.pdfOptions.pageLayout.margin,delete c.pdfOptions.pageLayout.margin,t&&c.pdfOptions.pageLayout.size||(c.pdfOptions.pageLayout.size=[c.width+c.pdfOptions.pageLayout.margins.left+c.pdfOptions.pageLayout.margins.right,c.height+c.pdfOptions.pageLayout.margins.top+c.pdfOptions.pageLayout.margins.bottom+(c.pdfOptions.addTitleToPage?2*c.pdfOptions.pdfTitleFontSize+10:0)+(""!==c.pdfOptions.chartCaption?4*c.pdfOptions.pdfCaptionFontSize+10:0)])}function n(t,n){c={width:100,height:100,scale:1,useCSS:!0,transparentBackgroundReplace:"white",pdfOptions:{customFonts:[],pageLayout:{margin:50,margins:{}},addTitleToPage:!0,chartCaption:"",pdfTextFontFamily:"Helvetica",pdfTitleFontSize:20,pdfCaptionFontSize:14}},n&&n.scale&&"number"==typeof n.scale&&(c.scale=n.scale),n&&n.height?"number"==typeof n.height&&(c.height=n.height*c.scale):c.height=document.querySelector(t).getBoundingClientRect().height*c.scale,n&&n.width?"number"==typeof n.width&&(c.width=n.width*c.scale):c.width=document.querySelector(t).getBoundingClientRect().width*c.scale,n&&!1===n.useCSS&&(c.useCSS=!1),n&&n.transparentBackgroundReplace&&(c.transparentBackgroundReplace=n.transparentBackgroundReplace),e(n)}function o(t,e){if("function"==typeof getComputedStyle){t.children.forEach(function(t,n){o(t,e.children[parseInt(n)])});var n=window.getComputedStyle(t);n.forEach(function(t){-1===["width","height","inline-size","block-size"].indexOf(t)&&e.style.setProperty(t,n.getPropertyValue(t))})}else alert("Warning svg-export: this browser is not able to get computed styles")}function i(t,e=!0){var n=document.querySelector(t).cloneNode(!0);if(c.useCSS&&o(document.querySelector(t),n),n.setAttribute("width",c.width),n.setAttribute("height",c.height),n.setAttribute("preserveAspectRatio","none"),n.setAttribute("viewBox","0 0 "+document.querySelector(t).getBoundingClientRect().width+" "+document.querySelector(t).getBoundingClientRect().height),e){var i=new XMLSerializer,a=i.serializeToString(n).replace(/currentColor/g,"black");return a.match(/^<svg[^>]+xmlns="http\:\/\/www\.w3\.org\/2000\/svg"/)||(a=a.replace(/^<svg/,'<svg xmlns="http://www.w3.org/2000/svg"')),a.match(/^<svg[^>]+"http\:\/\/www\.w3\.org\/1999\/xlink"/)||(a=a.replace(/^<svg/,'<svg xmlns:xlink="http://www.w3.org/1999/xlink"')),a}return n}function a(t){var e=[];return t.forEach(function(t){var n=new Promise(function(e,n){var o=new XMLHttpRequest;o.onreadystatechange=function(){4===o.readyState&&200===o.status&&e(o.response)},o.open("GET",t,!0),o.responseType="arraybuffer",o.send(null)});e.push(n)}),e}function p(t,e,n){if(e=e.replace(/[/\\?%*:|"<>]/g,"_"),navigator.msSaveBlob){for(var o=decodeURIComponent(t.split(",")[1]),i=[],a=t.split(",")[0].split(":")[1].split(";")[0],p=0;p<o.length;p++)i.push(o.charCodeAt(p));var r=null;return r=null!=n?n.msToBlob():new Blob([new Uint8Array(i)],{type:a}),navigator.msSaveBlob(r,e)}var s=document.createElement("a");s.download=e,s.href=t,document.body.appendChild(s),s.click(),document.body.removeChild(s)}function r(t,e,o){null==e&&(e="chart"),n(t,o);var a=i(t);a='<?xml version="1.0" standalone="no"?>\r\n'+a;var r="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(a);p(r,e+".svg")}function s(t,e,o,a){if("object"==typeof canvg){a=a.toLowerCase().replace("jpg","jpeg"),"png"!==a&&"jpeg"!==a&&(a="png"),null==e&&(e="chart");var r=document.createElement("canvas");o&&(o.width||o.height)||(o||(o={}),o.scale=10),n(t,o);var s=i(t);"jpeg"===a&&(s=s.replace(">",'><rect x="0" y="0" width="'+c.width+'" height="'+c.height+'" fill="'+c.transparentBackgroundReplace+'"/>'));var d=r.getContext("2d");canvg.Canvg.fromString(d,s).start();var f=r.toDataURL("image/"+a);p(f,e+"."+a,r)}else alert("Error svg-export: PNG/JPEG export requires Canvg.js")}function d(t,e,n){s(t,e,n,"png")}function f(t,e,n){s(t,e,n,"jpeg")}function g(t,e,n){c.pdfOptions.addTitleToPage&&t.font(c.pdfOptions.pdfTextFontFamily).fontSize(c.pdfOptions.pdfTitleFontSize).text(e,{width:c.pdfOptions.pageLayout.size[0]-c.pdfOptions.pageLayout.margins.left-c.pdfOptions.pageLayout.margins.right}),SVGtoPDF(t,n,c.pdfOptions.pageLayout.margins.left,t.y+10,{width:c.width,height:c.height,preserveAspectRatio:"none",useCSS:c.useCSS}),""!==c.pdfOptions.chartCaption&&t.font(c.pdfOptions.pdfTextFontFamily).fontSize(c.pdfOptions.pdfCaptionFontSize).text(c.pdfOptions.chartCaption,c.pdfOptions.pageLayout.margins.left,c.pdfOptions.pageLayout.size[1]-c.pdfOptions.pageLayout.margins.bottom-4*c.pdfOptions.pdfCaptionFontSize,{width:c.pdfOptions.pageLayout.size[0]-c.pdfOptions.pageLayout.margins.left-c.pdfOptions.pageLayout.margins.right})}function u(t,e,o){if("function"==typeof PDFDocument&&"function"==typeof SVGtoPDF&&"function"==typeof blobStream){null==e&&(e="chart"),n(t,o);var r=i(t,!1),s=new PDFDocument(c.pdfOptions.pageLayout),d=s.pipe(blobStream());if(c.pdfOptions.customFonts.length>0){var f=a(c.pdfOptions.customFonts.map(function(t){return t.url}));Promise.all(f).then(function(t){t.forEach(function(t,e){var n=c.pdfOptions.customFonts[parseInt(e)],o=r.querySelectorAll('[style*="'+n.fontName+'"]');o.forEach(function(t){t.style.fontFamily=n.fontName}),-1===n.url.indexOf(".ttc")&&-1===n.url.indexOf(".dfont")||!n.styleName?s.registerFont(n.fontName,t):s.registerFont(n.fontName,t,n.styleName)}),g(s,e,r),s.end()})}else g(s,e,r),s.end();d.on("finish",function(){var t=d.toBlobURL("application/pdf");p(t,e+".pdf")})}else alert("Error svg-export: PDF export requires PDFKit.js, blob-stream and SVG-to-PDFKit")}var l="1.0.0",c={};t.version=l,t.downloadSvg=r,t.downloadPng=d,t.downloadJpeg=f,t.downloadPdf=u,Object.defineProperty(t,"__esModule",{value:!0})});