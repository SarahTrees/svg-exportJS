(function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):(t="undefined"!=typeof globalThis?globalThis:t||self,e(t.svgExport=t.svgExport||{}))})(this,function(t){"use strict";function e(t){console.log(t),t&&t.pdfOptions&&(Object.keys(c.pdfOptions).forEach(function(e){if(t.pdfOptions.hasOwnProperty(e)&&typeof t.pdfOptions[e]==typeof c.pdfOptions[e]){if(""===t.pdfOptions[e])return;c.pdfOptions[e]=t.pdfOptions[e]}}),c.pdfOptions.pageLayout.margin||(c.pdfOptions.pageLayout.margin=50),c.pdfOptions.pageLayout.margins||(c.pdfOptions.pageLayout.margins={})),c.pdfOptions.pageLayout.margins.top=c.pdfOptions.pageLayout.margins.top||c.pdfOptions.pageLayout.margin,c.pdfOptions.pageLayout.margins.bottom=c.pdfOptions.pageLayout.margins.bottom||c.pdfOptions.pageLayout.margin,c.pdfOptions.pageLayout.margins.left=c.pdfOptions.pageLayout.margins.left||c.pdfOptions.pageLayout.margin,c.pdfOptions.pageLayout.margins.right=c.pdfOptions.pageLayout.margins.top||c.pdfOptions.pageLayout.margin,delete c.pdfOptions.pageLayout.margin,t&&c.pdfOptions.pageLayout.size||(c.pdfOptions.pageLayout.size=[c.width+c.pdfOptions.pageLayout.margins.left+c.pdfOptions.pageLayout.margins.right,c.height+c.pdfOptions.pageLayout.margins.top+c.pdfOptions.pageLayout.margins.bottom+(c.pdfOptions.addTitleToPage?2*c.pdfOptions.pdfTitleFontSize+10:0)+(""!==c.pdfOptions.chartCaption?4*c.pdfOptions.pdfCaptionFontSize+10:0)])}function o(t,o){c={width:100,height:100,scale:1,useCSS:!0,pdfOptions:{customFonts:[],pageLayout:{margin:50,margins:{}},addTitleToPage:!0,chartCaption:"",pdfTextFontFamily:"Helvetica",pdfTitleFontSize:20,pdfCaptionFontSize:14}},o&&o.scale&&"number"==typeof o.scale&&(c.scale=o.scale),o&&o.height?"number"==typeof o.height&&(c.height=o.height*c.scale):c.height=document.querySelector(t).getBBox().height*c.scale,o&&o.width?"number"==typeof o.width&&(c.width=o.width*c.scale):c.width=document.querySelector(t).getBBox().width*c.scale,o&&!1===o.useCSS&&(c.useCSS=!1),e(o)}function n(t,e){if("function"==typeof getComputedStyle){t.children.forEach(function(t,o){n(t,e.children[parseInt(o)])});var o=window.getComputedStyle(t);o.forEach(function(t){-1===["width","height","inline-size","block-size"].indexOf(t)&&e.style.setProperty(t,o.getPropertyValue(t))})}else alert("Warning svg-export: this browser is not able to get computed styles")}function i(t,e=!0){var o=document.querySelector(t).cloneNode(!0);if(c.useCSS&&n(document.querySelector(t),o),o.setAttribute("width",c.width),o.setAttribute("height",c.height),o.setAttribute("preserveAspectRatio","none"),o.setAttribute("viewBox","0 0 "+document.querySelector(t).getBBox().width+" "+document.querySelector(t).getBBox().height),e){var i=new XMLSerializer,p=i.serializeToString(o).replace(/currentColor/g,"black");return p.match(/^<svg[^>]+xmlns="http\:\/\/www\.w3\.org\/2000\/svg"/)||(p=p.replace(/^<svg/,'<svg xmlns="http://www.w3.org/2000/svg"')),p.match(/^<svg[^>]+"http\:\/\/www\.w3\.org\/1999\/xlink"/)||(p=p.replace(/^<svg/,'<svg xmlns:xlink="http://www.w3.org/1999/xlink"')),p}return o}function p(t){var e=[];return t.forEach(function(t){var o=new Promise(function(e,o){var n=new XMLHttpRequest;n.onreadystatechange=function(){4===n.readyState&&200===n.status&&e(n.response)},n.open("GET",t,!0),n.responseType="arraybuffer",n.send(null)});e.push(o)}),e}function a(t,e,o){if(e=e.replace(/[/\\?%*:|"<>]/g,"_"),navigator.msSaveBlob){for(var n=decodeURIComponent(t.split(",")[1]),i=[],p=t.split(",")[0].split(":")[1].split(";")[0],a=0;a<n.length;a++)i.push(n.charCodeAt(a));var s=null;return s=null!=o?o.msToBlob():new Blob([new Uint8Array(i)],{type:p}),navigator.msSaveBlob(s,e)}var r=document.createElement("a");r.download=e,r.href=t,document.body.appendChild(r),r.click(),document.body.removeChild(r)}function s(t,e,n){null==e&&(e="chart"),o(t,n);var p=i(t);p='<?xml version="1.0" standalone="no"?>\r\n'+p;var s="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(p);a(s,e+".svg")}function r(t,e,n,p){if("object"==typeof canvg){p=p.toLowerCase().replace("jpg","jpeg"),"png"!==p&&"jpeg"!==p&&(p="png"),null==e&&(e="chart");var s=document.createElement("canvas");n&&(n.width||n.height)||(n||(n={}),n.scale=10),o(t,n);var r=i(t);"jpeg"===p&&(r=r.replace(">",'><rect x="0" y="0" width="'+c.width+'" height="'+c.height+'" fill="white"/>'));var f=s.getContext("2d");canvg.Canvg.fromString(f,r).start();var d=s.toDataURL("image/"+p);a(d,e+"."+p,s)}else alert("Error svg-export: PNG/JPEG export requires Canvg.js")}function f(t,e,o){r(t,e,o,"png")}function d(t,e,o){r(t,e,o,"jpeg")}function g(t,e,o){c.pdfOptions.addTitleToPage&&t.font(c.pdfOptions.pdfTextFontFamily).fontSize(c.pdfOptions.pdfTitleFontSize).text(e,{width:c.pdfOptions.pageLayout.size[0]-c.pdfOptions.pageLayout.margins.left-c.pdfOptions.pageLayout.margins.right}),SVGtoPDF(t,o,c.pdfOptions.pageLayout.margins.left,t.y+10,{width:c.width,height:c.height,preserveAspectRatio:"none",useCSS:c.useCSS}),""!==c.pdfOptions.chartCaption&&t.font(c.pdfOptions.pdfTextFontFamily).fontSize(c.pdfOptions.pdfCaptionFontSize).text(c.pdfOptions.chartCaption,c.pdfOptions.pageLayout.margins.left,c.pdfOptions.pageLayout.size[1]-c.pdfOptions.pageLayout.margins.bottom-4*c.pdfOptions.pdfCaptionFontSize,{width:c.pdfOptions.pageLayout.size[0]-c.pdfOptions.pageLayout.margins.left-c.pdfOptions.pageLayout.margins.right})}function u(t,e,n){if("function"==typeof PDFDocument&&"function"==typeof SVGtoPDF&&"function"==typeof blobStream){null==e&&(e="chart"),o(t,n);var s=i(t,!1),r=new PDFDocument(c.pdfOptions.pageLayout),f=r.pipe(blobStream());if(c.pdfOptions.customFonts.length>0){var d=p(c.pdfOptions.customFonts.map(function(t){return t.url}));Promise.all(d).then(function(t){t.forEach(function(t,e){var o=c.pdfOptions.customFonts[parseInt(e)],n=s.querySelectorAll('[style*="'+o.fontName+'"]');n.forEach(function(t){t.style.fontFamily=o.fontName}),-1===o.url.indexOf(".ttc")&&-1===o.url.indexOf(".dfont")||!o.styleName?r.registerFont(o.fontName,t):r.registerFont(o.fontName,t,o.styleName)}),g(r,e,s),r.end()})}else g(r,e,s),r.end();f.on("finish",function(){var t=f.toBlobURL("application/pdf");a(t,e+".pdf")})}else alert("Error svg-export: PDF export requires PDFKit.js, blob-stream and SVG-to-PDFKit")}var l="1.0.0",c={};t.version=l,t.downloadSvg=s,t.downloadPng=f,t.downloadJpeg=d,t.downloadPdf=u,Object.defineProperty(t,"__esModule",{value:!0})});